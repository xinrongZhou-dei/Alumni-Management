import{_ as W,u as F,a as G,r as p,Y as L,o as j,Z as q,d as u,e as _,f as b,g as s,w as a,q as R,$ as Y,z as g,D as Z,h as $,i as H,j as n,k as t,t as o,p as K,F as Q,m as X,l as ee,I as te,a0 as le}from"./index-fee6fb78.js";const se={class:"visit-record-detail"},ae={key:0,class:"mobile-detail-list"},oe={class:"mobile-detail-item"},ie={class:"mobile-value"},ne={class:"mobile-detail-item"},de={class:"mobile-value"},ue={class:"mobile-detail-item"},re={class:"mobile-value"},ce={class:"mobile-detail-item"},me={class:"mobile-value"},_e={class:"mobile-detail-item"},ve={class:"mobile-value"},pe={class:"mobile-detail-item"},be={class:"mobile-value"},fe={class:"mobile-detail-item"},ye={class:"mobile-value"},ge={class:"mobile-detail-item"},De={class:"mobile-value"},Ee={class:"mobile-detail-item"},ke={class:"mobile-value"},xe={class:"mobile-detail-item"},Ne={class:"mobile-value"},Ve={class:"mobile-detail-item"},we={class:"mobile-value"},Re={key:2,class:"action-area"},he={__name:"VisitRecordDetail",setup(Te){const D=F(),h=G(),l=p({});p(JSON.parse(sessionStorage.getItem("user_info")||"{}"));const r=L({status:"APPROVED",remark:""}),T=[{value:"APPROVED",label:"批准"},{value:"REJECTED",label:"拒绝"}],E=i=>({PENDING:"warning",APPROVED:"success",REJECTED:"danger"})[i],k=i=>({PENDING:"待审核",APPROVED:"已批准",REJECTED:"已拒绝"})[i],x=i=>({MORNING:"上午(9:00-11:30)",AFTERNOON:"下午(13:30-16:00)"})[i],v=p(null),f=async()=>{try{const i=await Y(D.params.id);l.value=i.data}catch(i){console.error("获取预约详情失败:",i),g.error("获取预约详情失败")}},S=async()=>{try{await te.confirm("确认提交审核结果吗？","提示",{type:"warning"}),await le({visitUUID:l.value.visitUUID,status:r.status,remark:r.remark}),g.success("审核提交成功"),f()}catch(i){i!=="cancel"&&(console.error("审核提交失败:",i),g.error("审核提交失败"))}},I=()=>{h.push("/admin/visit-records")},M=i=>{const e=JSON.parse(i.data);e.type==="VISIT_RECORD_UPDATED"&&e.payload.visitUUID===D.params.id&&f()};function C(){v.value=Z({onMessage:M,onClose:()=>{}})}const m=p(!1),N=()=>{m.value=window.innerWidth<768};return j(()=>{N(),window.addEventListener("resize",N),f(),C()}),q(()=>{v.value&&v.value._manualClose&&v.value._manualClose()}),(i,e)=>{const P=u("el-icon"),V=u("el-button"),w=u("el-tag"),d=u("el-descriptions-item"),O=u("el-descriptions"),U=u("el-radio"),A=u("el-radio-group"),y=u("el-form-item"),B=u("el-input"),z=u("el-form"),J=u("el-card");return _(),b("div",se,[s(V,{type:"text",onClick:I,style:R(m.value?"position: absolute; left: 12px; top: 12px; font-size: 16px;":"position: absolute; left: 24px; top: 24px; font-size: 18px;")},{default:a(()=>[s(P,{style:{"vertical-align":"middle","margin-right":"4px"}},{default:a(()=>[s($(H))]),_:1}),e[2]||(e[2]=n("返回 "))]),_:1,__:[2]},8,["style"]),s(J,{class:"detail-card"},{header:a(()=>e[3]||(e[3]=[t("div",{class:"card-header"},[t("span",null,"预约详情")],-1)])),default:a(()=>[m.value?(_(),b("div",ae,[t("div",oe,[e[4]||(e[4]=t("div",{class:"mobile-label"},"校友姓名",-1)),t("div",ie,o(l.value.chineseName),1)]),t("div",ne,[e[5]||(e[5]=t("div",{class:"mobile-label"},"学号",-1)),t("div",de,o(l.value.alumniId),1)]),t("div",ue,[e[6]||(e[6]=t("div",{class:"mobile-label"},"当前位置",-1)),t("div",re,o(l.value.currentLocation),1)]),t("div",ce,[e[7]||(e[7]=t("div",{class:"mobile-label"},"联系方式",-1)),t("div",me,o(l.value.contactNumber),1)]),t("div",_e,[e[8]||(e[8]=t("div",{class:"mobile-label"},"预约校区",-1)),t("div",ve,o(l.value.visitSchool),1)]),t("div",pe,[e[9]||(e[9]=t("div",{class:"mobile-label"},"预约日期",-1)),t("div",be,o(l.value.visitDay),1)]),t("div",fe,[e[10]||(e[10]=t("div",{class:"mobile-label"},"预约时段",-1)),t("div",ye,o(x(l.value.visitTime)),1)]),t("div",ge,[e[11]||(e[11]=t("div",{class:"mobile-label"},"预约状态",-1)),t("div",De,[s(w,{type:E(l.value.status)},{default:a(()=>[n(o(k(l.value.status)),1)]),_:1},8,["type"])])]),t("div",Ee,[e[12]||(e[12]=t("div",{class:"mobile-label"},"创建时间",-1)),t("div",ke,o(l.value.createTime),1)]),t("div",xe,[e[13]||(e[13]=t("div",{class:"mobile-label"},"更新时间",-1)),t("div",Ne,o(l.value.updateTime),1)]),t("div",Ve,[e[14]||(e[14]=t("div",{class:"mobile-label"},"备注",-1)),t("div",we,o(l.value.remark||"无"),1)])])):(_(),K(O,{key:1,column:2,border:""},{default:a(()=>[s(d,{label:"校友姓名"},{default:a(()=>[n(o(l.value.chineseName),1)]),_:1}),s(d,{label:"学号"},{default:a(()=>[n(o(l.value.alumniId),1)]),_:1}),s(d,{label:"当前位置"},{default:a(()=>[n(o(l.value.currentLocation),1)]),_:1}),s(d,{label:"联系方式"},{default:a(()=>[n(o(l.value.contactNumber),1)]),_:1}),s(d,{label:"预约校区"},{default:a(()=>[n(o(l.value.visitSchool),1)]),_:1}),s(d,{label:"预约日期"},{default:a(()=>[n(o(l.value.visitDay),1)]),_:1}),s(d,{label:"预约时段"},{default:a(()=>[n(o(x(l.value.visitTime)),1)]),_:1}),s(d,{label:"预约状态"},{default:a(()=>[s(w,{type:E(l.value.status)},{default:a(()=>[n(o(k(l.value.status)),1)]),_:1},8,["type"])]),_:1}),s(d,{label:"创建时间"},{default:a(()=>[n(o(l.value.createTime),1)]),_:1}),s(d,{label:"更新时间"},{default:a(()=>[n(o(l.value.updateTime),1)]),_:1}),s(d,{label:"备注",span:2},{default:a(()=>[n(o(l.value.remark||"无"),1)]),_:1})]),_:1})),l.value.status==="PENDING"?(_(),b("div",Re,[s(z,{model:r,"label-width":m.value?"100px":"80px","label-position":m.value?"top":"right"},{default:a(()=>[s(y,{label:"审核结果"},{default:a(()=>[s(A,{modelValue:r.status,"onUpdate:modelValue":e[0]||(e[0]=c=>r.status=c)},{default:a(()=>[(_(),b(Q,null,X(T,c=>s(U,{key:c.value,label:c.value},{default:a(()=>[n(o(c.label),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),_:1}),s(y,{label:"备注"},{default:a(()=>[s(B,{modelValue:r.remark,"onUpdate:modelValue":e[1]||(e[1]=c=>r.remark=c),type:"textarea",rows:3,placeholder:"请输入审核备注"},null,8,["modelValue"])]),_:1}),s(y,null,{default:a(()=>[s(V,{type:"primary",onClick:S,style:R(m.value?"width: 100%;":"")},{default:a(()=>e[15]||(e[15]=[n("提交审核")])),_:1,__:[15]},8,["style"])]),_:1})]),_:1},8,["model","label-width","label-position"])])):ee("",!0)]),_:1})])}}},Ie=W(he,[["__scopeId","data-v-5783c9f7"]]);export{Ie as default};
