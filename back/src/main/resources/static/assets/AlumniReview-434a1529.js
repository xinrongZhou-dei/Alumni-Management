import{_ as F,a as G,r as s,c as H,o as P,A as $,d as i,a3 as K,e as b,f as z,g as t,w as o,k as p,h as _,a5 as O,p as x,t as c,b as Q,z as Y,i as J,j as m,F as X,m as Z}from"./index-fee6fb78.js";const ee={class:"alumni-review-container"},ae={class:"alumni-review-header"},ne={class:"alumni-review-search"},te={class:"table-wrapper"},le={class:"pagination-bar"},oe={class:"pagination-info"},ie={__name:"AlumniReview",setup(ue){const I=G(),k=()=>I.push("/"),C=s(!1),E=s(["YCIS Hong Kong","YCIS Shanghai","YCIS Beijing","YCIS Chongqing","YCIS Qingdao","YWIES Beijing","YWIES Guangzhou","YWIES Shanghai Gubei","YWIES Shanghai Lingang","YWIES Tongxiang","YWIES Yantai"]),l=s({alumniID:"",chinese_name:"",email:"",contact_number:"",ycyw_schools_attended:""}),h=s([]),r=s(0),u=s(1),v=s(10),y=s(!1),g=async()=>{y.value=!0;try{const n={alumniId:l.value.alumniID||void 0,chineseName:l.value.chinese_name||void 0,email:l.value.email||void 0,contactNumber:l.value.contact_number||void 0,ycywSchoolsAttended:l.value.ycyw_schools_attended||void 0,page:u.value,pageSize:v.value,state:"2,3"},e=await Q.get("/api/register/alumni-list",{params:n});e.data.code===0?(h.value=e.data.data.rows,r.value=e.data.data.total):(h.value=[],r.value=0,Y.error(e.data.msg||"获取校友列表失败"))}catch{h.value=[],r.value=0,Y.error("网络错误，获取校友列表失败")}y.value=!1},W=H(()=>h.value.filter(n=>n.state===2||n.state===3)),f=(()=>{let n=null;return()=>{n&&clearTimeout(n),n=setTimeout(()=>{u.value=1,g()},500)}})(),A=()=>{l.value={alumniID:"",chinese_name:"",email:"",contact_number:"",ycyw_schools_attended:""},u.value=1,g()},D=()=>{u.value=1,g()},N=n=>{I.push({path:`/alumni/detail/${n.alumniId}`,query:{from:"/alumni/review"}})};function T(n){return n===2?"待审核":n===3?"已拒绝":"未知"}function U(n){return n===2?"warning":n===3?"danger":"info"}return P(()=>{g();const n=()=>{C.value=window.innerWidth<=900};n(),window.addEventListener("resize",n),$(()=>{window.removeEventListener("resize",n)})}),(n,e)=>{const B=i("el-icon"),S=i("el-button"),w=i("el-input"),V=i("el-option"),L=i("el-select"),d=i("el-table-column"),j=i("el-tag"),R=i("el-table"),M=i("el-pagination"),q=K("loading");return b(),z("div",null,[t(S,{type:"text",onClick:k,class:"back-btn"},{default:o(()=>[t(B,{style:{"vertical-align":"middle","margin-right":"4px"}},{default:o(()=>[t(_(J))]),_:1}),e[7]||(e[7]=m("返回"))]),_:1,__:[7]}),p("div",ee,[p("div",ae,[p("div",ne,[t(w,{modelValue:l.value.alumniID,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.alumniID=a),placeholder:"按学号搜索",onInput:_(f),clearable:""},null,8,["modelValue","onInput"]),t(w,{modelValue:l.value.chinese_name,"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.chinese_name=a),placeholder:"按中文姓名搜索",onInput:_(f),clearable:""},null,8,["modelValue","onInput"]),t(w,{modelValue:l.value.email,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.email=a),placeholder:"按邮箱搜索",onInput:_(f),clearable:""},null,8,["modelValue","onInput"]),t(w,{modelValue:l.value.contact_number,"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.contact_number=a),placeholder:"按电话搜索",onInput:_(f),clearable:""},null,8,["modelValue","onInput"]),t(L,{modelValue:l.value.ycyw_schools_attended,"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.ycyw_schools_attended=a),onChange:_(f),clearable:"",placeholder:"就读学校"},{default:o(()=>[t(V,{value:""},{default:o(()=>e[8]||(e[8]=[m("全部学校")])),_:1,__:[8]}),(b(!0),z(X,null,Z(E.value,a=>(b(),x(V,{key:a,label:a,value:a},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"]),t(S,{onClick:A},{default:o(()=>e[9]||(e[9]=[m("清空")])),_:1,__:[9]})])]),p("div",te,[O((b(),x(R,{data:W.value,border:"",style:{width:"100%","margin-top":"18px"},"header-cell-style":{background:"#f9fafb",fontWeight:"bold"}},{default:o(()=>[t(d,{prop:"alumniId",label:"学号","min-width":"110"}),t(d,{prop:"chineseName",label:"中文姓名","min-width":"110"}),t(d,{label:"英文名/姓","min-width":"120"},{default:o(a=>[m(c(a.row.firstName)+"/"+c(a.row.lastName),1)]),_:1}),t(d,{prop:"ycywSchoolsAttended",label:"YCYW就读学校","min-width":"140"}),t(d,{prop:"updateTime",label:"信息最后更新时间","min-width":"160"},{default:o(a=>[m(c(a.row.updateTime||"-"),1)]),_:1}),t(d,{label:"状态","min-width":"100"},{default:o(a=>[t(j,{type:U(a.row.state),effect:"plain",style:{"font-weight":"bold","font-size":"1em"}},{default:o(()=>[m(c(T(a.row.state)),1)]),_:2},1032,["type"])]),_:1}),t(d,{label:"操作","min-width":"90"},{default:o(a=>[t(S,{type:"primary",size:"small",round:"",onClick:se=>N(a.row)},{default:o(()=>e[10]||(e[10]=[m("查看")])),_:2,__:[10]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[q,y.value]])]),p("div",le,[p("div",oe," 显示第"+c(r.value===0?0:(u.value-1)*v.value+1)+"到"+c(Math.min(u.value*v.value,r.value))+"条，共"+c(r.value)+"条记录 ",1),t(M,{background:"",layout:C.value?"sizes, prev, pager, next":"total, sizes, prev, pager, next, jumper",total:r.value,"current-page":u.value,"onUpdate:currentPage":e[5]||(e[5]=a=>u.value=a),"page-size":v.value,"onUpdate:pageSize":e[6]||(e[6]=a=>v.value=a),"page-sizes":[10,20,50,100],onSizeChange:D,onCurrentChange:g,class:"pagination-el"},null,8,["layout","total","current-page","page-size"])])])])}}},de=F(ie,[["__scopeId","data-v-61e6e177"]]);export{de as default};
