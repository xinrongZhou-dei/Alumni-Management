import{g as q,u as F,d as I}from"./emailTemplate-8aa76c0b.js";import{_ as W,a as $,r as p,K as j,o as D,d as o,e as u,f as k,g as e,w as a,q as H,k as d,n as J,F as K,m as O,h as P,i as R,j as _,p as x,l as G,t as Q,z as f}from"./index-fee6fb78.js";const X={class:"email-template-manage"},Y={class:"action-container"},Z={class:"template-card-list"},ee={class:"template-title"},te={class:"template-card-footer"},ae={__name:"EmailTemplateManage",setup(le){const g=$(),i=p("alumni"),v=p([]),b=p(0),n=p(window.innerWidth<=768);window.addEventListener("resize",()=>{n.value=window.innerWidth<=768});const m=async()=>{const s=await q(i.value);v.value=s.data},h=()=>{g.push({name:"EmailTemplateAdd",query:{target_type:i.value}})},C=async s=>{try{await F(s.id,s),f({message:"保存成功",type:"success",duration:2e3}),m()}catch{f.error("保存失败，请重试")}},E=async s=>{if(confirm("确定要删除该模版吗？"))try{await I(s.id),f({message:"删除成功",type:"success",duration:2e3}),m()}catch{f.error("删除失败，请重试")}},z=()=>{m()},M=()=>{g.push("/")},N=()=>{g.push({name:"EmailSend"})};return j(i,()=>{m()}),D(()=>{const s=JSON.parse(sessionStorage.getItem("admin_permissions")||"{}");b.value=s.email_template_permission||0,m()}),(s,t)=>{const S=o("el-icon"),r=o("el-button"),y=o("el-tab-pane"),U=o("el-tabs"),w=o("el-col"),B=o("el-row"),T=o("el-input"),V=o("el-form-item"),A=o("el-form"),L=o("el-card");return u(),k("div",X,[e(r,{type:"text",onClick:M,class:"back-btn",style:H(n.value?"position: static; margin-bottom: 16px;":"")},{default:a(()=>[e(S,{style:{"vertical-align":"middle","margin-right":"4px"}},{default:a(()=>[e(P(R))]),_:1}),t[1]||(t[1]=_("返回 "))]),_:1,__:[1]},8,["style"]),d("h2",{class:J({"mobile-title":n.value})},"邮件模版管理",2),e(U,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=l=>i.value=l),onTabChange:z},{default:a(()=>[e(y,{label:"校友邮件模版",name:"alumni"}),b.value===2?(u(),x(y,{key:0,label:"管理员邮件模版",name:"admin"})):G("",!0)]),_:1},8,["modelValue"]),d("div",Y,[e(B,{gutter:n.value?0:16},{default:a(()=>[e(w,{xs:24,sm:12,md:6,lg:4,class:"action-col"},{default:a(()=>[e(r,{type:"primary",onClick:h,class:"action-btn"},{default:a(()=>t[2]||(t[2]=[_("添加模版")])),_:1,__:[2]})]),_:1}),e(w,{xs:24,sm:12,md:6,lg:4,class:"action-col"},{default:a(()=>[e(r,{type:"success",onClick:N,class:"action-btn"},{default:a(()=>t[3]||(t[3]=[_("发送邮件")])),_:1,__:[3]})]),_:1})]),_:1},8,["gutter"])]),d("div",Z,[(u(!0),k(K,null,O(v.value,l=>(u(),x(L,{key:l.id,class:"template-card"},{default:a(()=>[d("div",ee,Q(l.templateName),1),e(A,{"label-width":n.value?"70px":"80px",class:"template-form","label-position":n.value?"top":"left"},{default:a(()=>[e(V,{label:"邮件主题"},{default:a(()=>[e(T,{modelValue:l.theme,"onUpdate:modelValue":c=>l.theme=c},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),e(V,{label:"邮件内容"},{default:a(()=>[e(T,{type:"textarea",modelValue:l.content,"onUpdate:modelValue":c=>l.content=c,rows:n.value?8:14},null,8,["modelValue","onUpdate:modelValue","rows"])]),_:2},1024)]),_:2},1032,["label-width","label-position"]),d("div",te,[e(r,{type:"primary",size:"small",onClick:c=>C(l),class:"footer-btn"},{default:a(()=>t[4]||(t[4]=[_("保存模版")])),_:2,__:[4]},1032,["onClick"]),e(r,{type:"danger",size:"small",onClick:c=>E(l),class:"footer-btn"},{default:a(()=>t[5]||(t[5]=[_("删除模版")])),_:2,__:[5]},1032,["onClick"])])]),_:2},1024))),128))])])}}},ne=W(ae,[["__scopeId","data-v-216b79ee"]]);export{ne as default};
